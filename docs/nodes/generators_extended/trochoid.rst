Trochoid
========

Functionality
-------------
The trochoid node creates a variety of 2D line patterns traced by a point attached to a moving circle that is rolling (without slipping) on a static circle or on a straight line. Some more familiar patterns are the cardioid (heart shape), the cycloid, the deltoid, the astroid (star shape) and the rosette (flower shape), but in general most of these patterns are spring, spiral, petal, ovoidal and braided like.

Based on the values of the main parameters (radii & height) and on whether the moving circle is rolling on the inside, outside of the static circle or on a straight line, the generated patterns fit into one of three categories: EPI, HYPO and LINE trochoids.

The EPI trochoids are the ones generated by a moving circle rolling on the outside of a static circle.

The HYPO trochoids are the ones generated by a moving circle rolling on the inside of a static circle (R1>R2) or the inside of a moving circle is rolling onto a static circle (R1<R2). The latter curves are also known as PERI-trochoids.

The LINE trochoids are called cycloids and are generated by a moving circle rolling on a straight line.

The value of the height parameter (H) can be larger, equal or smaller than the moving circle radius (R2). The trochoids generated with H < R2 are called curtate cycloids (these curves don't have loops or kinks). The trochoids generated with H = R2 are called common cycloids (these curves don't have loops, but have kinks). The trochoids generated with H > R2 are called prolate cycloids (these curves have loops and no kinks).

The hierarchy of various types of trochoids:

└── Trochoids
    ├── Linear Trochoids (moving circle on straight line)
    │   ├── Common Cycloid  (H = R2)
    │   ├── Curtate Cycloid (H < R2)
    │   └── Prolate Cycloid (H > R2)
    ├── EpiTrochoids (moving circle on outside static circle)
    │   ├── Common EpiCycloids (H = R2)
    │   │   ├── Cardioid    (R1 = 1 R2)
    │   │   ├── Nephroid    (R1 = 2 R2)
    │   │   └── Ranunculoid (R1 = 5 R2)
    │   ├── Curtate EpiCycloids (H < R2)
    │   └── Prolate EpiCycloids (H > R2)
    └── HypoTrochoids (moving circle on inside static circle)
        ├── Common HypoCycloids (H = R2)
        │   ├── Deltoid (R1 = 3 R2)
        │   └── Astroid (R1 = 4 R2)
        ├── Curtate HypoCycloids (H < R2)
        └── Prolate HypoCycloids (H > R2)

Additional parameters allow to further tweak the curves (phase, turns, resolution, scale and size) mainly to adjust the number of vertices and their position on the curve.

Note: If the ratio of the two radii R1/R2 is a rational number, the curve closes (repeats) itself after a number of turns equal to the R2 / gcd(R1,R2) (where gdc is the greatest common divisor).

Presets
-------
The node provides a set of presets corresponding to the main trochoid curves, some familiar curves as well as various somewhat interesting EPI and HYPO curves.

Inputs
------

All inputs are vectorized and they will accept single or multiple values.

- **Radius1** [1]
- **Radius2**
- **Height**
- **Phase1**
- **Phase2**
- **Turns** [2]
- **Resolution** [3]
- **Scale** [4]
- **Size** [5]

Notes:
[1] : In LINE mode the Radius1 is actually infinite and thus it is simply ignored in the generation of the cycloid patterns
[2] : The turns value can be a partial or a complete number of turns.
[3] : The total number of vertices in the curve depends on both Turns and Resolution (T x N)
[4] : The scale affects the main parameters: radii & height
[5] : The (normalized) size is available only when the "normalize" setting is on.

Parameters
----------

The **Trochoid Type** parameter allows to select one of the three modes: **EPI**, **LINE** and **HYPO**.

- In **EPI** mode the moving circle rolls outside of the static circle.
- In **HYPO** mode the moving circle rolls inside of the static circle.
- In **LINE** mode the moving circle rolls on a straight line

All parameters except **Mode**, **Norm**, **Swap** and **Close** can take values from the node itself or an external input.

The inputs are "sanitized" to restrict their values to valid domains:
- Radii, Height, Turns, Scale and Size are floats with values >= 0.0
- Resolution is an integer with values >= 3

+----------------+--------+---------+--------------------------------------------------------------------+
| Param          | Type   | Default | Description                                                        |
+================+========+=========+====================================================================+
| **Radius1**    | Float  | 6.0     | Radius of the static circle [1]                                    |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Radius2**    | Float  | 1.0     | Radius of the moving circle                                        |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Height**     | Float  | 4.0     | Distance from the drawing point to the center of the moving circle |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Phase1**     | Float  | 0.0     | The starting angle on the static circle                            |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Phase2**     | Float  | 0.0     | The starting angle on the moving circle                            |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Turns**      | Float  | 1.0     | Number of turns around the static circle                           |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Resolution** | Int    | 200     | Number of vertices in a complete turn around the static circle     |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Scale**      | Float  | 1.0     | Scale the main parameters (radii & height) [2]                     |
+----------------+--------+---------+--------------------------------------------------------------------+
| **Size**       | Float  | 1.0     | Normalized size of the entire curve [2]                            |
+----------------+--------+---------+--------------------------------------------------------------------+

Notes:
[1] : Radius1 is only used for EPI and HYPO trochoids as this is infinite for a straight line.
[2] : Scale is shown when normalize is OFF and size is shown when normalize is ON.

Outputs
-------
Outputs will be generated when connected.

**Verts**, **Edges**
These are the vertices and edges of the trochoid curves.

Example of usage
----------------

interesting settings (epi + hypo):

* 6 3 1
* 10 1 9
* 6 1 5
* 12 7 11
* 6 1 4
* 7 2 2
* 13 6 12
* 1 5 2
* 6 10 5 H

6 2 5
2 1 1
13 12 12
6 1 13
10 3 9
12 3 11
12 2 11
6 11 13
11 3 10
5 2 4
7 5 10
8 2 2
7 6 6
9 1 8
12 2 11
12 2 8


Essentials
└── Trochoids
    ├── Linear Trochoids (moving circle on straight line)
    │   ├── Common Cycloid  (H = R2)
    │   ├── Curtate Cycloid (H < R2)
    │   └── Prolate Cycloid (H > R2)
    ├── EpiTrochoids (moving circle on outside static circle)
    │   ├── Common EpiCycloids  (H = R2)
    │   ├── Curtate EpiCycloids (H < R2)
    │   └── Prolate EpiCycloids (H > R2)
    └── HypoTrochoids (moving circle on inside static circle)
        ├── Common HypoCycloids  (H = R2)
        ├── Curtate HypoCycloids (H < R2)
        └── Prolate HypoCycloids (H > R2)

# TODO
* add node icon
- fix closing point (remove duplicate)
- add start turn / end turn


